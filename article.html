<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>عرض المقال</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- الخط -->
  <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;700&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'El Messiri', sans-serif; background-color: #f9f9f9; margin: 0; padding: 0; }
    .container-article { max-width: 1200px; width: 95%; margin: auto; }
    .card-article { width: 100%; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 30px; }
    .card-body-article { padding: 25px; }
    .card-title { background: -webkit-linear-gradient(315deg, #1e30f3 0%, #e21e80 100%); -webkit-background-clip: text; color: transparent; margin: 15px 0; font-size: 1.5rem; font-weight: 700; }
    .card-text { line-height: 1.8; color: #444; }
    .btn-secondary { background-color: #333; color: #fff; border: none; border-radius: 5px; padding: 10px 15px; text-decoration: none; display: inline-block; margin-top: 15px; }
    .btn-secondary:hover { background-color: #555; }

    /* TOC */
    #toc { margin-bottom: 20px; padding: 15px; border-radius: 10px; background: #f1f1f1; }
    #toc ul { padding-left: 0; list-style:circle; }
    #toc li { margin: 5px 0; }
    #toc a { text-decoration:none;     background: -webkit-linear-gradient(315deg, #1e30f3 0%, #e21e80 100%);
    -webkit-background-clip: text;
    color: transparent; }
    #toc a:hover { text-decoration: underline; }

    /* Scroll to top */
    #scrollTopBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 99;
      background-color: #0077cc;
      color: white;
      border: none;
      padding: 12px 16px;
      border-radius: 50%;
      font-size: 18px;
      cursor: pointer;
      display: none;
    }
    #scrollTopBtn:hover { background-color: #005fa3; }
  </style>
</head>
<body>

  <div class="container-article my-5">
    <!-- Table of Contents -->
    <div id="toc">
      <h4>فهرس المقال</h4>
      <ul id="toc-list"></ul>
    </div>

    <!-- Article Card -->
    <div class="card-article">
      <div class="card-body-article">
        <div class="small text-muted mb-2" id="article-date"></div>
        <h2 class="card-title" id="article-title"></h2>
        <div class="card-text" id="article-content"></div>
        <p><strong>✍️ الكاتب:</strong> <span id="article-author"></span></p>
        <a href="index.html" class="btn btn-secondary">← العودة إلى الرئيسية</a>
      </div>
    </div>
  </div>

  <button onclick="scrollToTop()" id="scrollTopBtn" title="العودة للأعلى">↑</button>

  <script src="posts.js"></script>
  <script>
    window.onload = function() {
      const params = new URLSearchParams(window.location.search);
      const id = parseInt(params.get('id'));
      const post = posts[id];

      if (post) {
        document.getElementById('article-title').textContent = post.title;
        document.getElementById('article-content').innerHTML = post.content;
        document.getElementById('article-author').textContent = post.author;
        document.getElementById('article-date').textContent = post.date;

        // توليد الفهرس تلقائياً
        const contentDiv = document.getElementById('article-content');
        const tocList = document.getElementById('toc-list');
        const headers = contentDiv.querySelectorAll('h2, h3');

        headers.forEach((header, index) => {
          const idName = `header-${index}`;
          header.setAttribute('id', idName);
          const li = document.createElement('li');
          li.style.marginLeft = header.tagName === "H3" ? "20px" : "0px";
          const a = document.createElement('a');
          a.href = `#${idName}`;
          a.textContent = header.textContent;
          li.appendChild(a);
          tocList.appendChild(li);
        });
      } else {
        document.getElementById('article-title').textContent = "المقال غير موجود";
        document.getElementById('article-content').textContent = "عذراً، لا يمكن عرض المقال المطلوب.";
      }
    };

    // Scroll to top button
    const scrollBtn = document.getElementById("scrollTopBtn");
    window.onscroll = function() { scrollFunction(); };
    function scrollFunction() {
      if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
        scrollBtn.style.display = "block";
      } else {
        scrollBtn.style.display = "none";
      }
    }
    function scrollToTop() {
      document.body.scrollTop = 0;
      document.documentElement.scrollTop = 0;
    }
  </script>

</body>
</html>
